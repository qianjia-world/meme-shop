"use strict";(self["webpackChunkmeme_shop"]=self["webpackChunkmeme_shop"]||[]).push([[405],{3405:function(t,e,l){l.r(e),l.d(e,{default:function(){return it}});var a=l(6252),i=l(3577);const s={class:"text-end mt-2 me-2"},o={class:"table"},r=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"200"},"文章名稱"),(0,a._)("th",{width:"200"},"作者"),(0,a._)("th",{width:"350"},"發布日期"),(0,a._)("th",{width:"350"},"文章描述"),(0,a._)("th",{width:"350"},"關鍵字"),(0,a._)("th",{width:"200"},"是否公開"),(0,a._)("th",{width:"200"},"編輯")])],-1),c={key:0,class:"text-success"},d={key:1,class:"text-muted"},n={class:"btn-group"},p=["onClick"],m=["onClick"];function u(t,e,l,u,h,_){const b=(0,a.up)("DelModal"),f=(0,a.up)("EditModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("main",null,[(0,a._)("div",s,[(0,a._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>_.openModal(!0)),type:"button"},"新增文章")]),(0,a._)("table",o,[r,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.articles,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,i.zw)(e.title),1),(0,a._)("td",null,(0,i.zw)(e.author),1),(0,a._)("td",null,(0,i.zw)(t.$filters.date(e.create_at)),1),(0,a._)("td",null,(0,i.zw)(e.description),1),(0,a._)("td",null,(0,i.zw)(e.tag),1),(0,a._)("td",null,[e.isPublic?((0,a.wg)(),(0,a.iD)("span",c,"公開")):((0,a.wg)(),(0,a.iD)("span",d,"不公開"))]),(0,a._)("td",null,[(0,a._)("div",n,[(0,a._)("button",{onClick:t=>_.openModal(!1,e),class:"btn btn-outline-primary btn-sm"},"編輯",8,p),(0,a._)("button",{onClick:t=>_.openDeleteModal(e),class:"btn btn-outline-danger btn-sm"},"刪除",8,m)])])])))),128))])])]),(0,a.Wm)(b,{item:h.temparticle,ref:"delModal",onEmitDel:_.updateDelete},null,8,["item","onEmitDel"]),(0,a.Wm)(f,{article:h.temparticle,ref:"editModal",onEmitUpdate:_.updateArticle},null,8,["article","onEmitUpdate"])],64)}var h=l(2271),_=l(9963);const b={class:"modal fade",id:"editModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},f={class:"modal-dialog modal-xl",role:"document"},w={class:"modal-content border-0"},v=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"editModalLabel"},[(0,a._)("span",null,"新增文章")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),g={class:"modal-body"},x={class:"row"},y={class:"col-sm-4"},M={class:"mb-3"},k=(0,a._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),D={class:"mb-3"},$=(0,a._)("label",{for:"customFile",class:"form-label"},[(0,a.Uk)("或 上傳圖片 "),(0,a._)("i",{class:"fas fa-spinner fa-spin"})],-1),C=(0,a._)("img",{class:"img-fluid",alt:""},null,-1),U={class:"mt-5"},F={class:"mb-3"},P=(0,a._)("label",{for:"create_at",class:"form-label"},"新增日期",-1),V={class:"mb-3"},j=(0,a._)("label",{for:"exampleFormControlTextarea1",class:"form-label"},"文章描述",-1),q={class:"col-sm-8"},E={class:"mb-3"},T=(0,a._)("label",{for:"title",class:"form-label"},"標題",-1),z={class:"row gx-2"},N={class:"mb-3 col-md-6"},Z=(0,a._)("label",{for:"tag",class:"form-label"},"關鍵字",-1),I={class:"mb-3 col-md-6"},A=(0,a._)("label",{for:"author",class:"form-label"},"作者",-1),H={class:"row gx-2"},L={class:"mb-3"},S=(0,a._)("label",{for:"exampleFormControlTextarea1",class:"form-label"},"文章內容",-1),W=(0,a._)("hr",null,null,-1),Y={class:"mb-3"},K={class:"form-check"},O=(0,a._)("label",{class:"form-check-label",for:"isPublic"}," 是否公開 ",-1),B={class:"modal-footer"},G=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function J(t,e,l,i,s,o){return(0,a.wg)(),(0,a.iD)("div",b,[(0,a._)("div",f,[(0,a._)("div",w,[v,(0,a._)("div",g,[(0,a._)("div",x,[(0,a._)("div",y,[(0,a._)("div",M,[k,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=t=>s.temparticle.image=t)},null,512),[[_.nr,s.temparticle.image]])]),(0,a._)("div",D,[$,(0,a._)("input",{type:"file",id:"customFile",class:"form-control",onChange:e[1]||(e[1]=(...t)=>o.uploadFile&&o.uploadFile(...t)),ref:"fileInput"},null,544)]),C,(0,a._)("div",U,[(0,a._)("div",F,[P,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"create_at",placeholder:"請輸入新增日期","onUpdate:modelValue":e[2]||(e[2]=t=>s.create_at=t)},null,512),[[_.nr,s.create_at]])]),(0,a._)("div",V,[j,(0,a.wy)((0,a._)("textarea",{class:"form-control",id:"exampleFormControlTextarea1",rows:"3","onUpdate:modelValue":e[3]||(e[3]=t=>s.temparticle.description=t)},null,512),[[_.nr,s.temparticle.description]])])])]),(0,a._)("div",q,[(0,a._)("div",E,[T,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[4]||(e[4]=t=>s.temparticle.title=t)},null,512),[[_.nr,s.temparticle.title]])]),(0,a._)("div",z,[(0,a._)("div",N,[Z,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"tag",placeholder:"請輸入關鍵字","onUpdate:modelValue":e[5]||(e[5]=t=>s.temparticle.tag=t)},null,512),[[_.nr,s.temparticle.tag]])]),(0,a._)("div",I,[A,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"author",placeholder:"請輸入作者","onUpdate:modelValue":e[6]||(e[6]=t=>s.temparticle.author=t)},null,512),[[_.nr,s.temparticle.author]])])]),(0,a._)("div",H,[(0,a._)("div",L,[S,(0,a.wy)((0,a._)("textarea",{class:"form-control",id:"exampleFormControlTextarea1",rows:"18","onUpdate:modelValue":e[7]||(e[7]=t=>s.temparticle.content=t)},null,512),[[_.nr,s.temparticle.content]])])]),W,(0,a._)("div",Y,[(0,a._)("div",K,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",checked:"checked","true-value":!0,"false-value":!1,id:"is_enabled","onUpdate:modelValue":e[8]||(e[8]=t=>s.temparticle.isPublic=t)},null,512),[[_.e8,s.temparticle.isPublic]]),O])])])])]),(0,a._)("div",B,[G,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=e=>t.$emit("emit-update",s.temparticle))},"確認")])])])],512)}var Q=l(9826),R={data(){return{temparticle:{},create_at:""}},props:{article:{}},watch:{article(){this.temparticle=this.article;const t=new Date(1e3*this.temparticle.create_at).toISOString().split("T");this.create_at=t[0]},create_at(){this.temparticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const l="https://vue3-course-api.hexschool.io/api/qianjia-api/admin/upload";this.$http.post(l,e).then((t=>{t.data.success&&(this.temparticle.imageUrl=t.data.imageUrl)}))}},mixins:[Q.Z]},X=l(3744);const tt=(0,X.Z)(R,[["render",J]]);var et=tt,lt={data(){return{articles:[],temparticle:{},isNew:!1}},methods:{getProduct(t=1){const e=`https://vue3-course-api.hexschool.io/api/qianjia-api/admin/articles?page=${t}`;this.$http.get(e).then((t=>{this.articles=t.data.articles}))},openModal(t,e){if(this.isNew=t,this.isNew)this.temparticle={create_at:(new Date).getTime()/1e3};else{const t=`https://vue3-course-api.hexschool.io/api/qianjia-api/admin/article/${e.id}`;this.$http.get(t).then((t=>{this.temparticle=t.data.article}))}this.$refs.editModal.showModal()},updateArticle(t){if(this.isNew){const e="https://vue3-course-api.hexschool.io/api/qianjia-api/admin/article";this.$http.post(e,{data:t}).then((t=>{this.$refs.editModal.hideModal(),this.getProduct()}))}else{const e=`https://vue3-course-api.hexschool.io/api/qianjia-api/admin/article/${t.id}`;this.$http.put(e,{data:t}).then((t=>{this.$refs.editModal.hideModal(),this.getProduct()}))}},openDeleteModal(t){this.temparticle=t,this.$refs.delModal.showModal()},updateDelete(){const t=`https://vue3-course-api.hexschool.io/api/qianjia-api/admin/article/${this.temparticle.id}`;this.$http.delete(t).then((t=>{this.$refs.delModal.hideModal(),this.getProduct()}))}},created(){this.getProduct()},components:{EditModal:et,DelModal:h.Z}};const at=(0,X.Z)(lt,[["render",u]]);var it=at}}]);
//# sourceMappingURL=405.b3a5553e.js.map